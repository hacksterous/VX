#1>
 :run rsa.vex
 ## Info: executing :run rsa.vex
#2>
 num = random(256)
 ##  ans = 12, 475, 706, 133, 214, 745, 106, 241, 512, 504, 378, 093, 533, 296, 341, 466, 450, 284, 207, 997, 502, 158, 510, 528, 140, 404, 393, 682, 769, 797, 376, 229, 408, 949, 042, 321, 312, 909, 711, 714, 391, 832, 005, 279, 563, 609, 481, 492, 374, 383, 617, 401, 729, 991, 733, 608, 181, 140, 741, 337, 893, 957, 903, 742, 050, 245, 301, 292, 652, 157, 898, 100, 874, 719, 490, 844, 947, 830, 336, 409, 110, 635, 966, 080, 326, 481, 029, 161, 510, 098, 474, 325, 940, 258, 931, 656, 618, 657, 235, 229, 377, 057, 247, 430, 725, 946, 954, 868, 100, 508, 027, 702, 125, 996, 683, 467, 624, 861, 035, 378, 863, 450, 141, 040, 855, 487, 648, 859, 868, 256, 081, 942, 549, 349, 808, 384, 448, 321, 461, 666, 578, 981, 074, 763, 066, 763, 442, 780, 145, 065, 159, 076, 993, 004, 071, 990, 380, 385, 155, 237, 706, 758, 658, 822, 330, 849, 206, 270, 085, 047, 270, 435, 592, 269, 341, 841, 830, 368, 090, 639, 703, 634, 854, 215, 370, 710, 151, 382, 965, 441, 437, 720, 604, 991, 870, 943, 043, 425, 442, 751, 092, 817, 751, 257, 918, 508
#3>
 p = nxp(num)
 ##  ans = 12, 475, 706, 133, 214, 745, 106, 241, 512, 504, 378, 093, 533, 296, 341, 466, 450, 284, 207, 997, 502, 158, 510, 528, 140, 404, 393, 682, 769, 797, 376, 229, 408, 949, 042, 321, 312, 909, 711, 714, 391, 832, 005, 279, 563, 609, 481, 492, 374, 383, 617, 401, 729, 991, 733, 608, 181, 140, 741, 337, 893, 957, 903, 742, 050, 245, 301, 292, 652, 157, 898, 100, 874, 719, 490, 844, 947, 830, 336, 409, 110, 635, 966, 080, 326, 481, 029, 161, 510, 098, 474, 325, 940, 258, 931, 656, 618, 657, 235, 229, 377, 057, 247, 430, 725, 946, 954, 868, 100, 508, 027, 702, 125, 996, 683, 467, 624, 861, 035, 378, 863, 450, 141, 040, 855, 487, 648, 859, 868, 256, 081, 942, 549, 349, 808, 384, 448, 321, 461, 666, 578, 981, 074, 763, 066, 763, 442, 780, 145, 065, 159, 076, 993, 004, 071, 990, 380, 385, 155, 237, 706, 758, 658, 822, 330, 849, 206, 270, 085, 047, 270, 435, 592, 269, 341, 841, 830, 368, 090, 639, 703, 634, 854, 215, 370, 710, 151, 382, 965, 441, 437, 720, 604, 991, 870, 943, 043, 425, 442, 751, 092, 817, 751, 257, 919, 721
#4>
 num = random(255)
 ##  ans = 18, 271, 916, 507, 064, 223, 829, 790, 908, 485, 208, 074, 444, 260, 563, 399, 988, 569, 075, 208, 988, 374, 003, 958, 975, 377, 530, 258, 068, 368, 761, 838, 814, 418, 932, 561, 739, 185, 788, 005, 256, 368, 821, 740, 944, 238, 658, 576, 579, 931, 859, 236, 036, 979, 131, 259, 380, 261, 710, 543, 439, 747, 164, 862, 155, 653, 644, 896, 907, 647, 436, 550, 866, 308, 232, 091, 945, 411, 062, 416, 036, 785, 293, 681, 121, 317, 129, 202, 610, 038, 038, 786, 779, 829, 457, 989, 634, 158, 565, 096, 312, 461, 589, 260, 108, 787, 547, 386, 449, 587, 745, 098, 758, 871, 883, 893, 110, 233, 866, 718, 680, 928, 817, 677, 703, 306, 510, 340, 316, 641, 935, 789, 593, 587, 409, 281, 673, 626, 183, 381, 101, 268, 390, 653, 140, 296, 617, 963, 710, 162, 698, 157, 985, 360, 729, 383, 434, 287, 166, 818, 847, 280, 198, 188, 709, 806, 279, 600, 739, 655, 763, 046, 569, 053, 428, 970, 713, 825, 162, 173, 762, 501, 899, 796, 614, 478, 007, 032, 306, 871, 560, 176, 130, 166, 416, 955, 153, 212, 233, 281, 263, 156, 682, 888, 772
#5>
 q = nxp(num)
 ##  ans = 18, 271, 916, 507, 064, 223, 829, 790, 908, 485, 208, 074, 444, 260, 563, 399, 988, 569, 075, 208, 988, 374, 003, 958, 975, 377, 530, 258, 068, 368, 761, 838, 814, 418, 932, 561, 739, 185, 788, 005, 256, 368, 821, 740, 944, 238, 658, 576, 579, 931, 859, 236, 036, 979, 131, 259, 380, 261, 710, 543, 439, 747, 164, 862, 155, 653, 644, 896, 907, 647, 436, 550, 866, 308, 232, 091, 945, 411, 062, 416, 036, 785, 293, 681, 121, 317, 129, 202, 610, 038, 038, 786, 779, 829, 457, 989, 634, 158, 565, 096, 312, 461, 589, 260, 108, 787, 547, 386, 449, 587, 745, 098, 758, 871, 883, 893, 110, 233, 866, 718, 680, 928, 817, 677, 703, 306, 510, 340, 316, 641, 935, 789, 593, 587, 409, 281, 673, 626, 183, 381, 101, 268, 390, 653, 140, 296, 617, 963, 710, 162, 698, 157, 985, 360, 729, 383, 434, 287, 166, 818, 847, 280, 198, 188, 709, 806, 279, 600, 739, 655, 763, 046, 569, 053, 428, 970, 713, 825, 162, 173, 762, 501, 899, 796, 614, 478, 007, 032, 306, 871, 560, 176, 130, 166, 416, 955, 153, 212, 233, 281, 263, 156, 682, 890, 097
#6>
 WONTWORK = (p == q)
 ##  ans = False
#7>
 n = p * q
 ##  ans = 227955060832768879709752737907096796584075315320827800279785228756237461182837053630102352527191980365684845146315546372954710010573774825015721053134980014695073782327802206496055990245738450677008886561499977790666826389113383964435411882326681705179317836090138154431135515909910992140009593541249097144686541985622861699148423631388543360610286690993729538821202395999861454048850642021448241846307423646802766454460456802027109707135358051321392267413797137761164320871039755207851521187342349645756645484754123924923250115050031864529316747511430358944894488632143192103248696976362073229010652676246364688340107393496146692389648538019531879075351733609000149916492630762680758854128841109314223284510774439474885424885277810075899183897726765959419048994268359034853133776880742807536518975566804044680138111185724174690413173351669826777742421650898109019448329094561650533616850844974999836471632990954346534083576534081228534182824255043371271286311264575388155677776728465213244991889360652802265283028586190378634334295487255813041800683736486548276360866066377662352025187484478398787617104659065708225381854790961409238585809530752496586393810338029754771421906808203984490861532811498176602493633882942146291902937
#8>
 phi = (p-1)*(q-1)
 ##  ans = 227955060832768879709752737907096796584075315320827800279785228756237461182837053630102352527191980365684845146315546372954710010573774825015721053134980014695073782327802206496055990245738450677008886561499977790666826389113383964435411882326681705179317836090138154431135515909910992140009593541249097144686541985622861699148423631388543360610286690993729538821202395999861454048850642021448241846307423646802766454460456802027109707135358051321392267413797137761164320871039755207851521187342349645756645484754123924923250115050031864529316747511430358944894488632143192103248696976362073229010652676246364688327613415446424883059577234606668577467611131579149877139419919615796226754749069896286357539519526676013631550236380307678810809796422212239268098030719098068824421037440221804488081577915897132279183173636658629152987587552592787001994950124225357645440726748270937825104486117936238721863341597159873164374556548025486118695866639596146515730959746604118910095645658606680054036519152080078386944085190396648639246445527173469888080779997088439501039090915388229632261368042073873181678084139506695675696067864762770400190538729670580784516412981914587446792516810455675210080410774138178023838649508861238351093120
#9>
 enc = 101
 ##  ans = 101
#10>
 dec = 1/%[phi] enc
 ##  ans = 1
#11>
 mtxt = 12 #message
 ##  ans = 12
#12>
 ctxt = mtxt**%[n] enc #encrypted ciphertext
 ##  ans = 9, 938, 156, 942, 641, 746, 031, 009, 010, 831, 488, 421, 976, 193, 473, 742, 246, 733, 225, 570, 422, 369, 239, 059, 031, 961, 454, 676, 453, 243, 399, 562, 296, 232, 626, 880, 512
#13>
 ptxt = ctxt**%[n] dec #decrypted message, equals message
 ##  ans = 1
#14>
 mtxt == ptxt 
 ##  ans = False
#15>
 phi
 ##  ans = 227955060832768879709752737907096796584075315320827800279785228756237461182837053630102352527191980365684845146315546372954710010573774825015721053134980014695073782327802206496055990245738450677008886561499977790666826389113383964435411882326681705179317836090138154431135515909910992140009593541249097144686541985622861699148423631388543360610286690993729538821202395999861454048850642021448241846307423646802766454460456802027109707135358051321392267413797137761164320871039755207851521187342349645756645484754123924923250115050031864529316747511430358944894488632143192103248696976362073229010652676246364688327613415446424883059577234606668577467611131579149877139419919615796226754749069896286357539519526676013631550236380307678810809796422212239268098030719098068824421037440221804488081577915897132279183173636658629152987587552592787001994950124225357645440726748270937825104486117936238721863341597159873164374556548025486118695866639596146515730959746604118910095645658606680054036519152080078386944085190396648639246445527173469888080779997088439501039090915388229632261368042073873181678084139506695675696067864762770400190538729670580784516412981914587446792516810455675210080410774138178023838649508861238351093120
#16>
 dec = 1/%[phi] enc
 ##  ans = 1
#17>
 enc
 ##  ans = 101
#18>
 isp(p)
 ##  ans = True
#19>
 isp(q)
 ##  ans = True
